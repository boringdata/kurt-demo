# Default Workflows
# Built-in workflows that ship with Kurt plugin
# Users can execute these immediately: workflow run <workflow-name>

version: 1.0

workflows:
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Tutorial Refresh Workflow
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  tutorial-refresh:
    builtin: true
    name: "Tutorial Refresh"
    description: "Update outdated tutorials with traffic-based prioritization"

    parameters:
      search_term:
        description: "Keyword or topic to find tutorials (e.g., 'bigquery', 'authentication')"
        required: true
      content_type:
        description: "Content type filter (e.g., 'tutorial', 'guide')"
        required: false
        default: "tutorial"

    phases:
      - phase: identify-content
        description: "Find tutorials matching topic with traffic prioritization"
        tasks:
          - name: "Find tutorials"
            command: "intelligence identify-affected --search-term {{search_term}} --content-type {{content_type}}"
            output: "tutorial_candidates.md"

      - phase: prioritize
        description: "Review prioritization matrix and select targets"
        manual_steps:
          - "Review CRITICAL priority items (high traffic + declining)"
          - "Review HIGH priority items (high traffic)"
          - "Select 3-5 tutorials to update"
          - "Note: Focus on CRITICAL first for maximum impact"

      - phase: update-content
        description: "Update selected tutorials"
        tasks:
          - name: "Update each tutorial"
            command: "content-writing update {{project_name}} {{asset_name}}"
            repeat: true
            notes: "Run for each selected tutorial"

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Documentation Audit Workflow
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  documentation-audit:
    builtin: true
    name: "Documentation Audit"
    description: "Comprehensive traffic audit to identify content issues"

    parameters:
      domain:
        description: "Domain to audit (e.g., 'docs.company.com')"
        required: true

    phases:
      - phase: traffic-audit
        description: "Run comprehensive traffic analysis"
        tasks:
          - name: "Audit traffic patterns"
            command: "intelligence audit-traffic --domain {{domain}}"
            output: "audit_report.md"

      - phase: categorize-issues
        description: "Organize findings by issue type"
        manual_steps:
          - "Review high-traffic stale content (needs refresh)"
          - "Review declining traffic pages (needs investigation)"
          - "Review zero-traffic pages (orphaned or deprecated)"
          - "Prioritize by: urgency × traffic volume"

      - phase: create-project
        description: "Create project for highest-priority issues"
        tasks:
          - name: "Create update project"
            command: "project create"
            notes: "Use audit findings to populate project targets"

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Gap Analysis Workflow
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  gap-analysis:
    builtin: true
    name: "Gap Analysis"
    description: "Find missing content vs competitors"

    parameters:
      own_domain:
        description: "Your domain (e.g., 'docs.yourco.com')"
        required: true
      competitor_domain:
        description: "Competitor domain (e.g., 'docs.competitor.com')"
        required: true

    phases:
      - phase: identify-gaps
        description: "Find topics competitor has that you don't"
        tasks:
          - name: "Compare content gaps"
            command: "intelligence compare-gaps --own {{own_domain}} --competitor {{competitor_domain}}"
            output: "gap_analysis.md"

      - phase: estimate-impact
        description: "Estimate traffic potential of missing topics"
        tasks:
          - name: "Estimate impact for top gap"
            command: "intelligence impact-estimate --topic {{gap_topic}} --domain {{own_domain}}"
            repeat: true
            notes: "Run for each high-priority gap topic"

      - phase: prioritize-gaps
        description: "Select highest-value gaps to address"
        manual_steps:
          - "Review HIGH PRIORITY missing topics"
          - "Check impact estimates (HIGH: >5000 views/month potential)"
          - "Consider: strategic importance + traffic potential"
          - "Select 5-10 topics for content creation"

      - phase: create-content-plan
        description: "Create project for new content"
        tasks:
          - name: "Create gap-filling project"
            command: "project create"
            notes: "Intent: (b) Write new content to fill gaps"

  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  # Competitive Analysis Workflow
  # ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  competitive-analysis:
    builtin: true
    name: "Competitive Analysis"
    description: "Compare coverage and quality metrics vs competitor"

    parameters:
      own_domain:
        description: "Your domain (e.g., 'docs.yourco.com')"
        required: true
      competitor_domain:
        description: "Competitor domain (e.g., 'docs.competitor.com')"
        required: true

    phases:
      - phase: coverage-analysis
        description: "Compare content type and topic coverage"
        tasks:
          - name: "Compare coverage"
            command: "intelligence compare-coverage --own {{own_domain}} --competitor {{competitor_domain}}"
            output: "coverage_comparison.md"

      - phase: quality-analysis
        description: "Compare depth and quality metrics"
        tasks:
          - name: "Compare quality"
            command: "intelligence compare-quality --own {{own_domain}} --competitor {{competitor_domain}}"
            output: "quality_comparison.md"

      - phase: synthesize-findings
        description: "Identify improvement opportunities"
        manual_steps:
          - "Review coverage gaps (content types you're missing)"
          - "Review quality gaps (where theirs are more comprehensive)"
          - "Consider: Which gaps matter most to your users?"
          - "Note content type gaps (e.g., need more tutorials)"
          - "Note quality gaps (e.g., tutorials need more examples)"

      - phase: create-improvement-plan
        description: "Create project to close gaps"
        tasks:
          - name: "Create competitive improvement project"
            command: "project create"
            notes: "Use findings to guide project targets and quality bar"

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# Workflow Registry Notes
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Built-in workflows (this file):
#   - Checked into git
#   - Ship with Kurt plugin
#   - Cannot be modified by users
#   - Loaded automatically

# User workflows (.kurt/workflows/custom.yaml):
#   - Gitignored
#   - Created with: workflow add <name>
#   - Can be modified: workflow edit <name>
#   - User-specific customizations

# Usage:
#   workflow list                    # Show all workflows (built-in + user)
#   workflow run tutorial-refresh    # Execute built-in workflow
#   workflow add my-workflow         # Create new user workflow
